**实验二** **表维护命令** 

**一、目的和要求**

1. 掌握表结构的操作命令，包括建立、修改、显示和复制表结构的命令。

2. 掌握表数据的操作命令，包括表数据的复制、传送和替换命令。

3. 掌握表记录的移位、定位、追加和删除命令。 



三. 实验内容



##### 0.创建sb表

```
clear
create table sb(编号 c(5), 名称 c(6), 启用日期 d(8), 价格 n(9,2), 部门 c(2), 主要设备 l(1), 备注 m, 商标 g(4))
insert into sb values("016-1","车床",{90/03/05},62044.61,"21",.T.,"kk","kk")
insert into sb values("016-2","车床",{92/01/15},27132.73,"21",.T.,"kk","kk")
insert into sb values("037-2","磨床",{90/07/21},241292.12,"22",.T.,"kk","kk")
insert into sb values("038-1","钻床",{89/10/12},5275,"23",.F.,"kk","kk")
insert into sb values("100-1","微机",{97/12/08},8810,"12",.T.,"kk","kk")
insert into sb values("101-1","复印机",{92/01/06},10305.01,"12",.F.,"kk","kk")
insert into sb values("210-1","轿车",{95/08/05},151000.00,"11",.F.,"kk","kk")
list all

```



##### 1.**使用 copy 命令复制 sb 表为 a1，复制 sb 表的名称和编号字段为表 a2**

```
clear
use "sb.dbf" exclusive
list all
copy to a1
copy to a2 fields 名称,编号
use "a2.dbf"
display all
```

##### **2.** 

**将上题 a1 所有记录的名称和价格字段追加到 sb 表的末尾**。

提示：使用 append from 命令

```
use "sb.dbf"
append from a1 fields  名称,价格
list all
```

##### **3**. 

**对表** **SP.DBF** **按如下要求进行复制，写出命令序列：** 

1）将第 2 个到第 6 个记录中单价不小于 3000 的进口商品复制为表 sp5。 

2）将 1996 年 1 月 1 日及其以后开单的商品复制为 sp6。 

3）将表 SP.DBF 按系统数据格式复制为文本文件 sp.txt，再将 sp.txt 中的数据添加到表 sp6

中去。

提示：SP.DBF 已在实验一要求建立，参照有条件复制命令和例题。

```
USE sp
go 2
copy to sp5 next 5 for 单价>=3000 and 进口
COPY TO SP6 FOR 开单日期>={^1996/01/01}


COPY TO sp.txt SDF  && 以系统数据格式复制，产生文本文件sp.txt
TYPE sp.TXT     && 用type命令显示文本文件sp.txt的内容
USE SP6
append from sp.txt SDF  &&为什么不是 sp.txt，不能去掉sdf
LIST
```

##### **4**.

**从** **SP.DBF** **复制出** **sp1.dbf**，对 **sp1.dbf** **按以下要求写出命令序列。** 

1）将 SP.DBF 的全部记录追加到 sp1.dbf 中去，并查看经追加后的记录。 

```
use sp1
append from sp
list
```

2）用 scatter 和 gather 命令对 sp1.dbf 的第 3 个记录作如下修改：将单价由 3100.00 元改为

3500.00 元，在“备注”字段中填入内容“新产品提价”。

```
clear
use sp1
go 3  && 必须要记录指针位置
scatter to A memory
?A(4), A(8)
A(4)=3500
A(8)="新产品提价"
GATHER FROM A
DISPLAY

```



**5**. **由** **SP.DBF** **复制出备份文件** **sp2.dbf** **和** **sp3.dbf****，****sp2** **以界面操作方式修改结构，****sp3** **以命**

**令方式修改结构。要求如下：** 

1）将“数量”字段的宽度由 2 改为 3。 

2）将字段名“货号”改为“编号”，宽度由 6 改为 5。 

3）添加一个字段“总价 N（9，2）”。 

4）删除名为“生产单位”的字段



```visual basic
alter table sp3;
alter 数量 n(3,0);
alter 货号 c(5) rename column "货号" to "编号";
add 总价n(9,2);
drop 生产单位
```

##### 6.

**根据提供的班级名单** **EXCEL** **文件，建立本班学生的学生情况表** **xsqk.dbf**，**并按以下要求写出命令序列。** 

```
clear
create table class4 (学号c(4),姓名 c(20),性别,c(2),专业 c(10),班级 c(10),成绩 c(4))
insert into sb values("016-1","车床",{90/03/05},62044.61,"21",.T.,"kk","kk")
insert into sb values("016-2","车床",{92/01/15},27132.73,"21",.T.,"kk","kk")
insert into sb values("037-2","磨床",{90/07/21},241292.12,"22",.T.,"kk","kk")
insert into sb values("038-1","钻床",{89/10/12},5275,"23",.F.,"kk","kk")
insert into sb values("100-1","微机",{97/12/08},8810,"12",.T.,"kk","kk")
insert into sb values("101-1","复印机",{92/01/06},10305.01,"12",.F.,"kk","kk")
insert into sb values("210-1","轿车",{95/08/05},151000.00,"11",.F.,"kk","kk")
list all

```

