根据下列技术指标，设计一个线性相位的FIR数字低通滤波器。通带截止频率![img](file:///C:\Users\29066\AppData\Local\Temp\ksohtml13896\wps105.png)，通带允许波动![img](file:///C:\Users\29066\AppData\Local\Temp\ksohtml13896\wps106.png)；阻带截止频率![img](file:///C:\Users\29066\AppData\Local\Temp\ksohtml13896\wps107.png)，阻带衰减![img](file:///C:\Users\29066\AppData\Local\Temp\ksohtml13896\wps108.png)。 用三种方式.

前两种方式

```matlab
wp=0.2*pi;    %截止频率
ws=0.3*pi;    %阻带截止频率
Ap=0.2;      %通带允许波动 0.25dB
As=40;        %阻带衰减 50db     
wc=(wp+ws)/2;  %理想低通滤波器的截止频率，对应designer当中的Fc                 	
N=ceil(8*pi/(ws-wp));   %哈明窗 窗长 ,阶数是N-1
a=(N-1)/2;   n=0:100;    
x=sin(wc*(n-a))./(pi*(n-a));  %待滤波的信号   
hn=abs(fft(x,512));

w1= hamming(N);       %返回长度为N的哈明窗函数，即滤波器的频谱响应
hn1=x(1:N).*w1';     
Hn1=abs(fft(hn1,512)); 
hn2=fir1(N-1,wc/pi,w1);   Hn2=abs(fft(hn2,512)); 
w2= HAM_f;  %使用designer得到的 
Hn3=abs(fft(w2,512)); 
figure( 'Name', '用3种方法实现FIR低通滤波器');  
subplot(421);  stem(n,x); title('待滤波波形'); %未滤波
subplot(422);  plot(hn);
subplot(423); stem(hn1);  title('way1：编写代码实现');
subplot(424);  plot(Hn1); 
subplot(425); stem(hn2);title('way2：fir1实现');
subplot(426);  plot(Hn2);  
subplot(427); stem(w2);title('way3：designer实现');
subplot(428);  plot(Hn3);  
```

第3种方式 使用 filter designer

$f_s$ 是采样频率， $f_c$ 是3db截止频率
$$
w_c=\Omega T= 2\pi*f_c *\frac{1}{f_s}得到 f_c=\frac{w_c*f_s}{2*\pi}
$$
 由 $f_s=48000,w_c=0.25*\pi$ 得到， $f_c=6000$

再代入计算得到的N=80，得到

![mark](http://mally.oss-cn-qingdao.aliyuncs.com/PicGo上传的图片/20201202/211344651.png)



生成的函数如下

```matlab
function b = HAM_f
%HAM_F Returns a discrete-time filter object.

% MATLAB Code
% Generated by MATLAB(R) 9.2 and the Signal Processing Toolbox 7.4.
% Generated on: 02-Dec-2020 20:51:59

% FIR Window Lowpass filter designed using the FIR1 function.

% All frequency values are in Hz.
Fs = 48000;  % Sampling Frequency

N    = 80;       % Order
Fc   = 6000;     % Cutoff Frequency
flag = 'scale';  % Sampling Flag

% Create the window vector for the design algorithm.
win = hamming(N+1);

% Calculate the coefficients using the FIR1 function.
b  = fir1(N, Fc/(Fs/2), 'low', win, flag);  %只要输出这个就可以
% Hd = dfilt.dffir(b);  要把这句注释掉

% [EOF]

```



<img src="http://mally.oss-cn-qingdao.aliyuncs.com/PicGo上传的图片/20201208/220135551.png" alt="mark" style="zoom:50%;" />



（2）调用fir1()函数得到所设计的低通滤波器的单位脉冲响应，调用fft()函数进行频响验证。打印输出各部分结果。

#### 2.

**编程验证窗长和窗形状对实际滤波器性能的影响。如要求用窗函数法设计一个线性相位FIR数字低通滤波器，用理想低通滤波器作为逼近滤波器，截止频率，用四种窗函数（矩形窗，汉宁窗（升余弦窗），哈明窗（改进的升余弦窗），布莱克曼窗）设计该滤波器，选择窗函数的长度两种情况。**

```matlab
wc=0.25*pi;   %技术指标
N=29;  
w1= boxcar(N); %矩阵窗
w2= hanning(N);  %汉宁窗
w3=hamming(N);   %哈明窗
wbk=blackman(N); %布莱克曼窗
B1=fir1(N-1,wc/pi,w1);  B2=fir1(N-1,wc/pi,w2);  
B3=fir1(N-1,wc/pi,w3);  B4=fir1(N-1,wc/pi,wbk);
H1=fft(B1,1,512); H2=fft(B2,1,512);
H3=fft(B3,1,512);H4=fft(B4,1,512);
fvtool(H1,1,H2,1,H3,1,H4,1);
```

n=12时

<img src="http://mally.oss-cn-qingdao.aliyuncs.com/PicGo上传的图片/20201208/223348432.png" alt="mark" style="zoom:45%;" />

n=29时

<img src="http://mally.oss-cn-qingdao.aliyuncs.com/PicGo上传的图片/20201208/223442592.png" alt="mark" style="zoom: 33%;" />

<img src="http://mally.oss-cn-qingdao.aliyuncs.com/PicGo上传的图片/20201208/223526657.png" alt="mark" style="zoom: 33%;" />

















